<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Saturday, January 31, 2015, 6:06 PM -->
<!-- MuClient version 4.73 -->

<!-- Plugin "Steals" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Steals"
   author="Kloke"
   id="6a41dd06e8629798c8c66b4d"
   language="Lua"
   purpose="Keep track of successful, failed and out of stock steal attempts."
   save_state="y"
   date_written="2015-01-31 18:03:56"
   requires="1.00"
   version="1.1"
   >
   <description trim="y">
   <![CDATA[
      Steals V1.1
      Keep track of successful, failed and out of stock steal attempts, and the % of success.

      Commands:

      stealstart   - reports totals so far and resets all counts to 0
      stealreport  - reports totals so far. Does not reset counts.


TODO:
	*	Add details on what's needed and how to use the plugin on load
   *  Track who the current player is and keep their progress
   ]]>
</description>

</plugin>


<!--  Get our standard constants -->
<include name="constants.lua"/>

<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   match="*Pssst, they don't have one of those.*"
   send_to="12"
   sequence="100"
   >
      <send>
		 Action ("psst")
      </send>
   </trigger>
   <trigger
      enabled="y"
      match="(You steal*|You deftly relieve*|doesn't spot you and you manage to steal*|With deft fingers, you steal*|With expert skill, you steal*)"
      send_to="12"
      sequence="100"
	  regexp="y"
   >
      <send>
         Action ("steal")
      </send>
   </trigger>
   <trigger
      enabled="y"
      match="*stealstart*"
      send_to="12"
      sequence="100"
   >
      <send>
		 Action ("start")
      </send>
   </trigger>
   <trigger
      enabled="y"
      match="*stealreport*"
      send_to="12"
      sequence="100"
   >
      <send>
         Report ()
      </send>
   </trigger>
   <trigger
      enabled="y"
      match="(You tried to steal*|You try to steal*)"
      send_to="12"
      sequence="100"
	  regexp="y"
   >
      <send>
         Action ("fail")
      </send>
   </trigger>
   </triggers>

<!--  Aliases  -->

<aliases>
   <alias
      match="stealstart"
      enabled="y"
      send_to="12"
      sequence="100"
   >
      <send>
         Action ("start")
      </send>
   </alias>
   <alias
      script="Report"
	  match="stealreport"
      enabled="y"
      send_to="12"
      sequence="100"
   >
   </alias>
</aliases>

<!--  Variables  -->

<variables>
   <variable name="stealfails">0</variable>
   <variable name="psssts">0</variable>
   <variable name="steals">0</variable>
   <variable name="stealpercent">100</variable>
</variables>

<!--  Plugin help  -->

<aliases>
   <alias
      script="OnHelp"
      match="Steals:help"
      enabled="y"
   >
   </alias>
</aliases>

<script>
   <![CDATA[
      function OnHelp ()
         world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
      end
	  function Report ()
	     if not stealpercent then 
		    psssts = 0
            steals = 0
            stealfails = 0
		    stealpercent = 100
		 end
	     world.Note ("Steals: " .. steals .. " | Fails: " .. stealfails .. " | Psssts: " .. psssts .. " Success Rate: " .. math.floor(stealpercent) .. "%")
	  end
	  function Reset ()
		Note ("Old Values:")
		Report ()		 
		psssts = 0
		steals = 0
		stealfails = 0
		stealpercent = 100
		Note ("Steal Values Reset:")
		Report ()	  
	  end -- function Reset
	  function Action (func)
		if not steals then
			Reset ()
		end -- if	  
	     if func == "start" then
			Reset ()
		 elseif func == "steal" then 
		    steals = steals + 1
			stealpercent = (steals/(steals+stealfails))*100
			Report ()
		 elseif func == "fail" then 
		    stealfails = stealfails + 1
			stealpercent = (steals/(steals+stealfails))*100
			Report ()
		 elseif func == "psst" then 
		    psssts = psssts + 1
			Report ()
		 end
	  end
   ]]>
</script> 

</muclient>
